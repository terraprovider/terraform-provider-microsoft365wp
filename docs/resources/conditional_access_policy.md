---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "microsoft365wp_conditional_access_policy Resource - microsoft365wp"
subcategory: ""
description: |-
  https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessPolicy?view=graph-rest-beta
---

# microsoft365wp_conditional_access_policy (Resource)

https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessPolicy?view=graph-rest-beta

## Example Usage

```terraform
terraform {
  required_providers {
    microsoft365wp = {
      source = "tfp-c4a8-workplace.c4a8.io/c4a8/microsoft365wp"
    }
  }
}

/*
.env
export ARM_TENANT_ID='...'
export ARM_CLIENT_ID='...'
export ARM_CLIENT_SECRET='...'
*/


resource "microsoft365wp_conditional_access_policy" "test_grant" {
  display_name = "TF Test Grant"
  conditions = {
    applications = {
      include_applications = ["None"]
    }
    users = {
      include_users = ["None"]
    }
  }
  grant_controls = {
    operator                = "AND"
    authentication_strength = { id = "00000000-0000-0000-0000-000000000004" }
    built_in_controls       = ["compliantDevice"]
  }
}

resource "microsoft365wp_conditional_access_policy" "test_session" {
  display_name = "TF Test Session"
  conditions = {
    applications = {
      include_applications = ["None"]
    }
    users = {
      include_users = ["298fded6-b252-4166-a473-f405e935f58d"]
      include_guests_or_external_users = {
        external_tenants = {
          membership_kind = "all"
          all             = {}
        }
        guest_or_external_user_types = "b2bCollaborationGuest,b2bCollaborationMember,b2bDirectConnectUser"
      }
      exclude_guests_or_external_users = {
        external_tenants = {
          membership_kind = "enumerated"
          enumerated = {
            members = ["62e39046-aad3-4423-98e0-b486e3538aff"]
          }
        }
        guest_or_external_user_types = "internalGuest,b2bCollaborationGuest,b2bCollaborationMember,b2bDirectConnectUser,otherExternalUser,serviceProvider"
      }
    }
  }
  session_controls = {
    sign_in_frequency = {
      authentication_type = "primaryAndSecondaryAuthentication"
      frequency_interval  = "timeBased"
      value               = 10
      type                = "hours"
      is_enabled          = true
    }
    disable_resilience_defaults = true
  }
}

resource "microsoft365wp_conditional_access_policy" "test_combined" {
  display_name = "TF Test Combined"
  conditions = {
    applications = {
      include_applications = ["All"]
    }
    users = {
      include_users = ["298fded6-b252-4166-a473-f405e935f58d"]
    }
    user_risk_levels = ["medium"]
  }
  grant_controls = {
    operator                = "AND"
    authentication_strength = { id = "00000000-0000-0000-0000-000000000003" }
    built_in_controls       = ["passwordChange"]
  }
  session_controls = {
    sign_in_frequency = {
      authentication_type = "primaryAndSecondaryAuthentication"
      frequency_interval  = "everyTime"
      is_enabled          = true
    }
  }
  state = "disabled"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `conditions` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessConditionSet?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions))
- `display_name` (String)

### Optional

- `grant_controls` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessGrantControls?view=graph-rest-beta (see [below for nested schema](#nestedatt--grant_controls))
- `session_controls` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessSessionControls?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls))
- `state` (String)

### Read-Only

- `created_date_time` (String)
- `id` (String) The ID of this resource.

<a id="nestedatt--conditions"></a>
### Nested Schema for `conditions`

Optional:

- `applications` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessApplications?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--applications))
- `authentication_flows` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessAuthenticationFlows?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--authentication_flows))
- `client_app_types` (Set of String)
- `client_applications` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessClientApplications?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--client_applications))
- `device_states` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessDeviceStates?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--device_states))
- `devices` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessDevices?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--devices))
- `insider_risk_levels` (String)
- `locations` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessLocations?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--locations))
- `platforms` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessPlatforms?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--platforms))
- `service_principal_risk_levels` (Set of String)
- `sign_in_risk_levels` (Set of String)
- `user_risk_levels` (Set of String)
- `users` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessUsers?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users))

<a id="nestedatt--conditions--applications"></a>
### Nested Schema for `conditions.applications`

Optional:

- `application_filter` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessFilter?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--applications--application_filter))
- `exclude_applications` (Set of String)
- `include_applications` (Set of String)
- `include_authentication_context_class_references` (Set of String)
- `include_user_actions` (Set of String)

<a id="nestedatt--conditions--applications--application_filter"></a>
### Nested Schema for `conditions.applications.application_filter`

Required:

- `mode` (String)
- `rule` (String)



<a id="nestedatt--conditions--authentication_flows"></a>
### Nested Schema for `conditions.authentication_flows`

Required:

- `transfer_methods` (String)


<a id="nestedatt--conditions--client_applications"></a>
### Nested Schema for `conditions.client_applications`

Optional:

- `exclude_service_principals` (Set of String)
- `include_service_principals` (Set of String)
- `service_principal_filter` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessFilter?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--client_applications--service_principal_filter))

<a id="nestedatt--conditions--client_applications--service_principal_filter"></a>
### Nested Schema for `conditions.client_applications.service_principal_filter`

Required:

- `mode` (String)
- `rule` (String)



<a id="nestedatt--conditions--device_states"></a>
### Nested Schema for `conditions.device_states`

Optional:

- `exclude_states` (Set of String)
- `include_states` (Set of String)


<a id="nestedatt--conditions--devices"></a>
### Nested Schema for `conditions.devices`

Optional:

- `device_filter` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessFilter?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--devices--device_filter))
- `exclude_device_states` (Set of String)
- `exclude_devices` (Set of String)
- `include_device_states` (Set of String)
- `include_devices` (Set of String)

<a id="nestedatt--conditions--devices--device_filter"></a>
### Nested Schema for `conditions.devices.device_filter`

Required:

- `mode` (String)
- `rule` (String)



<a id="nestedatt--conditions--locations"></a>
### Nested Schema for `conditions.locations`

Optional:

- `exclude_locations` (Set of String)
- `include_locations` (Set of String)


<a id="nestedatt--conditions--platforms"></a>
### Nested Schema for `conditions.platforms`

Required:

- `include_platforms` (Set of String)

Optional:

- `exclude_platforms` (Set of String)


<a id="nestedatt--conditions--users"></a>
### Nested Schema for `conditions.users`

Optional:

- `exclude_groups` (Set of String)
- `exclude_guests_or_external_users` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessGuestsOrExternalUsers?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--exclude_guests_or_external_users))
- `exclude_roles` (Set of String)
- `exclude_users` (Set of String)
- `include_groups` (Set of String)
- `include_guests_or_external_users` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessGuestsOrExternalUsers?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--include_guests_or_external_users))
- `include_roles` (Set of String)
- `include_users` (Set of String)

<a id="nestedatt--conditions--users--exclude_guests_or_external_users"></a>
### Nested Schema for `conditions.users.exclude_guests_or_external_users`

Required:

- `guest_or_external_user_types` (String)

Optional:

- `external_tenants` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessExternalTenants?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--exclude_guests_or_external_users--external_tenants))

<a id="nestedatt--conditions--users--exclude_guests_or_external_users--external_tenants"></a>
### Nested Schema for `conditions.users.exclude_guests_or_external_users.external_tenants`

Optional:

- `all` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessAllExternalTenants?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--exclude_guests_or_external_users--external_tenants--all))
- `enumerated` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessEnumeratedExternalTenants?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--exclude_guests_or_external_users--external_tenants--enumerated))
- `membership_kind` (String)

<a id="nestedatt--conditions--users--exclude_guests_or_external_users--external_tenants--all"></a>
### Nested Schema for `conditions.users.exclude_guests_or_external_users.external_tenants.all`


<a id="nestedatt--conditions--users--exclude_guests_or_external_users--external_tenants--enumerated"></a>
### Nested Schema for `conditions.users.exclude_guests_or_external_users.external_tenants.enumerated`

Required:

- `members` (Set of String)




<a id="nestedatt--conditions--users--include_guests_or_external_users"></a>
### Nested Schema for `conditions.users.include_guests_or_external_users`

Required:

- `guest_or_external_user_types` (String)

Optional:

- `external_tenants` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessExternalTenants?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--include_guests_or_external_users--external_tenants))

<a id="nestedatt--conditions--users--include_guests_or_external_users--external_tenants"></a>
### Nested Schema for `conditions.users.include_guests_or_external_users.external_tenants`

Optional:

- `all` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessAllExternalTenants?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--include_guests_or_external_users--external_tenants--all))
- `enumerated` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/conditionalAccessEnumeratedExternalTenants?view=graph-rest-beta (see [below for nested schema](#nestedatt--conditions--users--include_guests_or_external_users--external_tenants--enumerated))
- `membership_kind` (String)

<a id="nestedatt--conditions--users--include_guests_or_external_users--external_tenants--all"></a>
### Nested Schema for `conditions.users.include_guests_or_external_users.external_tenants.all`


<a id="nestedatt--conditions--users--include_guests_or_external_users--external_tenants--enumerated"></a>
### Nested Schema for `conditions.users.include_guests_or_external_users.external_tenants.enumerated`

Required:

- `members` (Set of String)






<a id="nestedatt--grant_controls"></a>
### Nested Schema for `grant_controls`

Required:

- `operator` (String)

Optional:

- `authentication_strength` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/authenticationStrengthPolicy?view=graph-rest-beta (see [below for nested schema](#nestedatt--grant_controls--authentication_strength))
- `built_in_controls` (Set of String)
- `custom_authentication_factors` (Set of String)
- `terms_of_use` (Set of String)

<a id="nestedatt--grant_controls--authentication_strength"></a>
### Nested Schema for `grant_controls.authentication_strength`

Required:

- `id` (String)

Read-Only:

- `allowed_combinations` (Set of String)
- `created_date_time` (String)
- `description` (String)
- `display_name` (String)
- `modified_date_time` (String)
- `policy_type` (String)
- `requirements_satisfied` (String)



<a id="nestedatt--session_controls"></a>
### Nested Schema for `session_controls`

Optional:

- `application_enforced_restrictions` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/applicationEnforcedRestrictionsSessionControl?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls--application_enforced_restrictions))
- `cloud_app_security` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/cloudAppSecuritySessionControl?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls--cloud_app_security))
- `continuous_access_evaluation` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/continuousAccessEvaluationSessionControl?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls--continuous_access_evaluation))
- `disable_resilience_defaults` (Boolean)
- `persistent_browser` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/persistentBrowserSessionControl?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls--persistent_browser))
- `secure_sign_in_session` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/secureSignInSessionControl?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls--secure_sign_in_session))
- `sign_in_frequency` (Attributes) https://learn.microsoft.com/en-us/graph/api/resources/signInFrequencySessionControl?view=graph-rest-beta (see [below for nested schema](#nestedatt--session_controls--sign_in_frequency))

<a id="nestedatt--session_controls--application_enforced_restrictions"></a>
### Nested Schema for `session_controls.application_enforced_restrictions`

Optional:

- `is_enabled` (Boolean)


<a id="nestedatt--session_controls--cloud_app_security"></a>
### Nested Schema for `session_controls.cloud_app_security`

Optional:

- `cloud_app_security_type` (String)
- `is_enabled` (Boolean)


<a id="nestedatt--session_controls--continuous_access_evaluation"></a>
### Nested Schema for `session_controls.continuous_access_evaluation`

Optional:

- `mode` (String)


<a id="nestedatt--session_controls--persistent_browser"></a>
### Nested Schema for `session_controls.persistent_browser`

Optional:

- `is_enabled` (Boolean)
- `mode` (String)


<a id="nestedatt--session_controls--secure_sign_in_session"></a>
### Nested Schema for `session_controls.secure_sign_in_session`

Optional:

- `is_enabled` (Boolean)


<a id="nestedatt--session_controls--sign_in_frequency"></a>
### Nested Schema for `session_controls.sign_in_frequency`

Optional:

- `authentication_type` (String)
- `frequency_interval` (String)
- `is_enabled` (Boolean)
- `type` (String)
- `value` (Number)


